<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CalcHub - Calculator & Converter</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Archivo:wght@300;500;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:        #0a0e1a;
    --surface:   #151a2b;
    --surface2:  #1a2033;
    --border:    #2a3245;
    --text:      #e8ecf5;
    --muted:     #7d8899;
    --accent:    #5b9eff;
    --accent2:   #4a7fcc;
    --green:     #4ade80;
    --orange:    #fb923c;
    --calc-display: #0d1117;
    --calc-number:  #1c2128;
    --calc-operator:#1e3a5f;
    --calc-function:#252932;
  }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 0;
    margin: 0;
    overflow-x: hidden;
  }

  /* --- app header --- */
  .app-header {
    background: var(--surface);
    border-bottom: 2px solid var(--border);
    padding: 20px 24px;
    text-align: center;
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
    background: rgba(21, 26, 43, 0.95);
  }
  .app-header h1 {
    font-size: 1.6rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent), var(--green));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 6px;
  }
  .app-header p {
    font-size: .82rem;
    color: var(--muted);
    font-weight: 400;
  }

  /* --- main navigation tabs --- */
  .main-nav {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 24px;
    display: flex;
    gap: 4px;
    position: sticky;
    top: 76px;
    z-index: 99;
    backdrop-filter: blur(10px);
    background: rgba(21, 26, 43, 0.95);
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  .main-nav::-webkit-scrollbar {
    height: 3px;
  }
  .main-nav::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 3px;
  }
  .main-nav button {
    flex-shrink: 0;
    min-width: 100px;
    padding: 14px 16px;
    border: none;
    background: transparent;
    color: var(--muted);
    font-family: inherit;
    font-size: .85rem;
    font-weight: 600;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all .2s;
    letter-spacing: .02em;
    white-space: nowrap;
  }
  .main-nav button:hover {
    color: var(--text);
    background: rgba(255,255,255,.02);
  }
  .main-nav button.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }

  /* --- content area --- */
  .content {
    flex: 1;
    display: flex;
    justify-content: center;
    padding: 32px 20px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
  }

  .view {
    display: none;
    width: 100%;
    animation: fadeIn .3s ease;
  }
  .view.active { display: block; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ========================================
     CALCULATOR STYLES
     ======================================== */
  .calculator-container {
    max-width: 440px;
    margin: 0 auto;
  }

  .calculator {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .calc-header {
    text-align: center;
    margin-bottom: 20px;
  }
  .calc-header h2 {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: .06em;
  }
  .calc-header p {
    font-size: .72rem;
    color: var(--muted);
    margin-top: 4px;
    letter-spacing: .08em;
  }

  .display {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 18px 16px;
    margin-bottom: 20px;
    min-height: 88px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    gap: 4px;
  }
  .expression {
    font-family: 'JetBrains Mono', monospace;
    font-size: .82rem;
    color: var(--muted);
    min-height: 1.2em;
    text-align: right;
    word-break: break-all;
  }
  .result {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--text);
    text-align: right;
    word-break: break-all;
    line-height: 1.2;
  }

  .mode-toggle {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
    background: var(--calc-display);
    border-radius: 10px;
    padding: 6px;
  }
  .mode-toggle button {
    flex: 1;
    padding: 8px;
    border: none;
    border-radius: 7px;
    font-family: inherit;
    font-size: .75rem;
    font-weight: 600;
    cursor: pointer;
    background: transparent;
    color: var(--muted);
    transition: all .2s;
    letter-spacing: .04em;
    text-transform: uppercase;
  }
  .mode-toggle button.active {
    background: var(--surface);
    color: var(--accent);
    box-shadow: 0 2px 6px rgba(0,0,0,.2);
  }

  .buttons {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
  }

  .calc-btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: .88rem;
    font-weight: 600;
    padding: 16px 8px;
    border: 1px solid var(--border);
    border-radius: 10px;
    cursor: pointer;
    transition: all .15s;
    background: var(--calc-number);
    color: var(--text);
  }

  .calc-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,.3);
    border-color: var(--accent);
  }
  .calc-btn:active {
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(0,0,0,.2);
  }

  .btn-operator {
    background: var(--calc-operator);
    color: var(--accent);
    font-weight: 700;
  }
  .btn-function {
    background: var(--calc-function);
    font-size: .76rem;
  }
  .btn-clear {
    background: #3d1f1f;
    color: #ff6b6b;
    font-weight: 700;
  }
  .btn-equals {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    font-weight: 700;
    grid-column: span 2;
  }
  .btn-equals:hover {
    background: linear-gradient(135deg, var(--accent2), var(--accent));
  }

  .error { color: #ff6b6b; }

  /* ========================================
     SIMPLE CALCULATOR STYLES
     ======================================== */
  .simple-calc-container {
    max-width: 380px;
    margin: 0 auto;
  }

  .simple-calc {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .simple-display {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px 20px;
    margin-bottom: 20px;
    min-height: 100px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    gap: 6px;
  }

  .simple-expression {
    font-family: 'JetBrains Mono', monospace;
    font-size: .9rem;
    color: var(--muted);
    min-height: 1.3em;
    text-align: right;
  }

  .simple-result {
    font-family: 'JetBrains Mono', monospace;
    font-size: 2.2rem;
    font-weight: 700;
    color: var(--text);
    text-align: right;
    line-height: 1.2;
  }

  .simple-buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
  }

  .simple-btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.1rem;
    font-weight: 600;
    padding: 20px;
    border: 1px solid var(--border);
    border-radius: 12px;
    cursor: pointer;
    transition: all .15s;
    background: var(--calc-number);
    color: var(--text);
  }

  .simple-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,.3);
  }

  .simple-btn:active {
    transform: translateY(0);
  }

  .simple-btn.op {
    background: var(--calc-operator);
    color: var(--accent);
    font-weight: 700;
  }

  .simple-btn.clear {
    background: #3d1f1f;
    color: #ff6b6b;
  }

  .simple-btn.equals {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    grid-column: span 2;
  }

  .simple-btn.zero {
    grid-column: span 2;
  }

  /* ========================================
     EQUATION SOLVER STYLES
     ======================================== */
  .solver-container {
    max-width: 600px;
    margin: 0 auto;
  }

  .solver-card {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .solver-header {
    text-align: center;
    margin-bottom: 24px;
  }

  .solver-header h2 {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .solver-header p {
    font-size: .85rem;
    color: var(--muted);
    line-height: 1.6;
  }

  .equation-input-group {
    margin-bottom: 20px;
  }

  .equation-input-group label {
    display: block;
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 8px;
    font-weight: 600;
  }

  .equation-input {
    width: 100%;
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 1rem;
    color: var(--text);
    outline: none;
    transition: border-color .2s;
  }

  .equation-input:focus {
    border-color: var(--accent);
  }

  .solve-btn {
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none;
    border-radius: 12px;
    color: #fff;
    font-family: inherit;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
    letter-spacing: .04em;
    text-transform: uppercase;
  }

  .solve-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(91, 158, 255, 0.4);
  }

  .solution-box {
    margin-top: 24px;
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    display: none;
  }

  .solution-box.visible {
    display: block;
    animation: fadeIn .3s ease;
  }

  .solution-title {
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 12px;
  }

  .solution-result {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--green);
    margin-bottom: 20px;
  }

  .solution-steps {
    border-top: 1px solid var(--border);
    padding-top: 16px;
  }

  .solution-steps h4 {
    font-size: .82rem;
    text-transform: uppercase;
    letter-spacing: .08em;
    color: var(--muted);
    margin-bottom: 12px;
  }

  .step {
    font-family: 'JetBrains Mono', monospace;
    font-size: .88rem;
    color: var(--text);
    padding: 10px 0;
    border-bottom: 1px solid rgba(255,255,255,.05);
  }

  .step:last-child {
    border-bottom: none;
  }

  .step-num {
    color: var(--accent);
    font-weight: 700;
    margin-right: 8px;
  }

  /* ========================================
     FINANCE CALCULATOR STYLES
     ======================================== */
  .finance-container {
    max-width: 600px;
    margin: 0 auto;
  }

  .finance-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 6px;
  }

  .finance-tab {
    flex: 1;
    padding: 10px 12px;
    border: none;
    background: transparent;
    color: var(--muted);
    font-family: inherit;
    font-size: .82rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }

  .finance-tab:hover {
    color: var(--text);
    background: var(--surface2);
  }

  .finance-tab.active {
    background: var(--accent);
    color: #fff;
  }

  .finance-card {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .finance-section {
    display: none;
  }

  .finance-section.active {
    display: block;
    animation: fadeIn .3s ease;
  }

  .finance-input-group {
    margin-bottom: 16px;
  }

  .finance-input-group label {
    display: block;
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 6px;
    font-weight: 600;
  }

  .finance-input {
    width: 100%;
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 14px;
    font-family: 'JetBrains Mono', monospace;
    font-size: .95rem;
    color: var(--text);
    outline: none;
    transition: border-color .2s;
  }

  .finance-input:focus {
    border-color: var(--accent);
  }

  .finance-result-box {
    margin-top: 20px;
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
  }

  .finance-result-label {
    font-size: .72rem;
    text-transform: uppercase;
    letter-spacing: .12em;
    color: var(--muted);
    margin-bottom: 6px;
  }

  .finance-result-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.8rem;
    font-weight: 600;
    color: var(--green);
  }

  .finance-breakdown {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border);
  }

  .breakdown-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    font-size: .88rem;
  }

  .breakdown-item span:first-child {
    color: var(--muted);
  }

  .breakdown-item span:last-child {
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-weight: 600;
  }

  /* ========================================
     ANALOG CLOCK STYLES
     ======================================== */
  .clock-container {
    max-width: 500px;
    margin: 0 auto;
  }

  .clock-card {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .clock-header {
    text-align: center;
    margin-bottom: 24px;
  }

  .clock-header h2 {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .clock-header p {
    font-size: .85rem;
    color: var(--muted);
  }

  .analog-clock {
    width: 300px;
    height: 300px;
    margin: 0 auto 24px;
    position: relative;
    background: var(--calc-display);
    border: 4px solid var(--border);
    border-radius: 50%;
    box-shadow: inset 0 0 20px rgba(0,0,0,.3);
  }

  .clock-center {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 12px;
    height: 12px;
    background: var(--accent);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
  }

  .clock-number {
    position: absolute;
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text);
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hand {
    position: absolute;
    bottom: 50%;
    left: 50%;
    transform-origin: bottom center;
    border-radius: 4px 4px 0 0;
    cursor: grab;
    transition: background .2s;
  }

  .hand:active {
    cursor: grabbing;
  }

  .hour-hand {
    width: 6px;
    height: 80px;
    background: var(--accent);
    margin-left: -3px;
  }

  .minute-hand {
    width: 4px;
    height: 110px;
    background: var(--green);
    margin-left: -2px;
  }

  .time-display {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
  }

  .digital-time {
    font-family: 'JetBrains Mono', monospace;
    font-size: 2rem;
    font-weight: 700;
    color: var(--green);
    margin-bottom: 8px;
  }

  .time-description {
    font-size: .88rem;
    color: var(--muted);
  }

  .clock-controls {
    margin-top: 16px;
    display: flex;
    gap: 8px;
  }

  .clock-btn {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 8px;
    font-family: inherit;
    font-size: .82rem;
    font-weight: 600;
    cursor: pointer;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }

  .clock-btn.primary {
    background: var(--accent);
    color: #fff;
  }

  .clock-btn.secondary {
    background: var(--surface2);
    color: var(--muted);
    border: 1px solid var(--border);
  }

  .clock-btn:hover {
    transform: translateY(-1px);
  }

  /* ========================================
     GEOMETRY CALCULATOR STYLES
     ======================================== */
  .geometry-container {
    max-width: 700px;
    margin: 0 auto;
  }

  .geometry-tabs {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 8px;
    margin-bottom: 20px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 6px;
  }

  .geometry-tab {
    padding: 10px 12px;
    border: none;
    background: transparent;
    color: var(--muted);
    font-family: inherit;
    font-size: .8rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }

  .geometry-tab:hover {
    color: var(--text);
    background: var(--surface2);
  }

  .geometry-tab.active {
    background: var(--accent);
    color: #fff;
  }

  .geometry-card {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .geometry-section {
    display: none;
  }

  .geometry-section.active {
    display: block;
    animation: fadeIn .3s ease;
  }

  .geometry-header {
    text-align: center;
    margin-bottom: 20px;
  }

  .geometry-header h3 {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 6px;
  }

  .geometry-header p {
    font-size: .82rem;
    color: var(--muted);
  }

  .geometry-visual {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 180px;
  }

  .shape-svg {
    max-width: 100%;
    height: auto;
  }

  .geometry-inputs {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 12px;
    margin-bottom: 20px;
  }

  .geometry-input-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .geometry-input-group label {
    font-size: .75rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    font-weight: 600;
  }

  .geometry-input {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    font-family: 'JetBrains Mono', monospace;
    font-size: .95rem;
    color: var(--text);
    outline: none;
    transition: border-color .2s;
  }

  .geometry-input:focus {
    border-color: var(--accent);
  }

  .geometry-results {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
  }

  .geometry-results h4 {
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 16px;
  }

  .geometry-result-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
  }

  .geometry-result-item:last-child {
    border-bottom: none;
  }

  .geometry-result-label {
    font-size: .88rem;
    color: var(--text);
  }

  .geometry-result-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--green);
  }

  .formula-hint {
    font-size: .75rem;
    color: var(--muted);
    font-style: italic;
    margin-top: 4px;
    font-family: 'JetBrains Mono', monospace;
  }

  /* ========================================
     MATH GAMES STYLES
     ======================================== */
  .games-container {
    max-width: 700px;
    margin: 0 auto;
  }

  .game-setup {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
    text-align: center;
  }

  .game-setup h2 {
    font-size: 1.6rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 12px;
  }

  .game-setup p {
    font-size: .9rem;
    color: var(--muted);
    margin-bottom: 28px;
  }

  .grade-selector {
    margin-bottom: 24px;
  }

  .grade-selector label {
    display: block;
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 12px;
    font-weight: 600;
  }

  .grade-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
    gap: 8px;
    margin-bottom: 24px;
  }

  .grade-btn {
    padding: 12px 8px;
    border: 2px solid var(--border);
    background: var(--surface2);
    color: var(--text);
    font-family: inherit;
    font-size: .85rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 10px;
    transition: all .2s;
  }

  .grade-btn:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
  }

  .grade-btn.selected {
    background: var(--accent);
    border-color: var(--accent);
    color: #fff;
  }

  .game-mode-selector {
    margin-bottom: 28px;
  }

  .game-mode-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 12px;
  }

  .game-mode-btn {
    padding: 16px 12px;
    border: 2px solid var(--border);
    background: var(--surface2);
    color: var(--text);
    font-family: inherit;
    font-size: .88rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 12px;
    transition: all .2s;
    text-align: center;
  }

  .game-mode-btn .mode-icon {
    font-size: 1.8rem;
    display: block;
    margin-bottom: 8px;
  }

  .game-mode-btn .mode-name {
    display: block;
    margin-bottom: 4px;
  }

  .game-mode-btn .mode-desc {
    font-size: .72rem;
    color: var(--muted);
    font-weight: 400;
  }

  .game-mode-btn:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
  }

  .game-mode-btn.selected {
    background: var(--accent);
    border-color: var(--accent);
    color: #fff;
  }

  .game-mode-btn.selected .mode-desc {
    color: rgba(255,255,255,.8);
  }

  .start-game-btn {
    width: 100%;
    max-width: 300px;
    padding: 16px 32px;
    background: linear-gradient(135deg, var(--green), #22c55e);
    border: none;
    border-radius: 12px;
    color: #fff;
    font-family: inherit;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .06em;
  }

  .start-game-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 222, 128, 0.4);
  }

  .start-game-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }

  /* Game Play Area */
  .game-play {
    display: none;
  }

  .game-play.active {
    display: block;
    animation: fadeIn .3s ease;
  }

  .game-header-bar {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 16px;
    padding: 20px 24px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 16px;
  }

  .game-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .game-stat-label {
    font-size: .72rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 4px;
  }

  .game-stat-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--green);
  }

  .timer-value {
    color: var(--orange);
  }

  .game-content {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 20px;
    padding: 40px 32px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
    min-height: 400px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .question-display {
    font-family: 'JetBrains Mono', monospace;
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--text);
    text-align: center;
    margin-bottom: 32px;
    line-height: 1.3;
  }

  .answer-input {
    width: 100%;
    max-width: 300px;
    background: var(--calc-display);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 20px 24px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 2rem;
    font-weight: 700;
    color: var(--text);
    text-align: center;
    outline: none;
    transition: border-color .2s;
    margin-bottom: 24px;
  }

  .answer-input:focus {
    border-color: var(--accent);
  }

  .answer-input.correct {
    border-color: var(--green);
    animation: correctPulse .5s ease;
  }

  .answer-input.wrong {
    border-color: #ef4444;
    animation: shake .4s ease;
  }

  @keyframes correctPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
  }

  .submit-answer-btn {
    padding: 14px 48px;
    background: var(--accent);
    border: none;
    border-radius: 12px;
    color: #fff;
    font-family: inherit;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }

  .submit-answer-btn:hover {
    background: var(--accent2);
    transform: translateY(-2px);
  }

  .multiple-choice-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    width: 100%;
    max-width: 500px;
  }

  .choice-btn {
    padding: 24px 20px;
    background: var(--surface2);
    border: 2px solid var(--border);
    border-radius: 12px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.6rem;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
  }

  .choice-btn:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
  }

  .choice-btn.correct {
    background: var(--green);
    border-color: var(--green);
    color: #fff;
  }

  .choice-btn.wrong {
    background: #ef4444;
    border-color: #ef4444;
    color: #fff;
  }

  .game-over-screen {
    text-align: center;
  }

  .game-over-screen h2 {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--green);
    margin-bottom: 16px;
  }

  .final-score {
    font-family: 'JetBrains Mono', monospace;
    font-size: 3rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 24px;
  }

  .game-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 16px;
    margin-bottom: 32px;
  }

  .game-stat-card {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
  }

  .game-stat-card-label {
    font-size: .72rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .game-stat-card-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--text);
  }

  .game-buttons {
    display: flex;
    gap: 12px;
    justify-content: center;
  }

  .game-btn {
    padding: 14px 32px;
    border: none;
    border-radius: 12px;
    font-family: inherit;
    font-size: .95rem;
    font-weight: 700;
    cursor: pointer;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }

  .game-btn.primary {
    background: var(--accent);
    color: #fff;
  }

  .game-btn.secondary {
    background: var(--surface2);
    color: var(--text);
    border: 2px solid var(--border);
  }

  .game-btn:hover {
    transform: translateY(-2px);
  }

  /* Speed Round specific */
  .speed-progress {
    width: 100%;
    max-width: 500px;
    height: 8px;
    background: var(--calc-display);
    border-radius: 4px;
    margin-bottom: 24px;
    overflow: hidden;
  }

  .speed-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--green), var(--accent));
    transition: width .3s ease;
    border-radius: 4px;
  }

  @media (max-width: 600px) {
    .question-display { font-size: 1.8rem; }
    .answer-input { font-size: 1.5rem; padding: 16px 20px; }
    .choice-btn { font-size: 1.3rem; padding: 20px 16px; }
    .final-score { font-size: 2.2rem; }
  }

  /* ========================================
     CONVERTER STYLES
     ======================================== */
  .converter-container {
    max-width: 560px;
    margin: 0 auto;
  }

  .category-tabs {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin-bottom: 24px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 6px;
  }
  .cat-tab {
    padding: 12px 8px;
    border: none;
    background: transparent;
    color: var(--muted);
    font-family: inherit;
    font-size: .84rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all .2s;
    text-transform: uppercase;
    letter-spacing: .04em;
  }
  .cat-tab:hover { 
    color: var(--text); 
    background: var(--surface2); 
  }
  .cat-tab.active {
    background: var(--accent);
    color: #fff;
  }

  .converter-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }

  .converter {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .unit-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .unit-group label {
    font-size: .78rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    font-weight: 600;
  }

  .input-row {
    display: flex;
    gap: 10px;
  }
  input[type="number"] {
    flex: 1;
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 16px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.1rem;
    color: var(--text);
    outline: none;
    transition: border-color .2s;
  }
  input[type="number"]:focus { border-color: var(--accent); }

  select {
    flex: 1;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 16px;
    font-family: inherit;
    font-size: .92rem;
    color: var(--text);
    cursor: pointer;
    outline: none;
    transition: border-color .2s;
  }
  select:focus { border-color: var(--accent); }

  .swap-row {
    display: flex;
    justify-content: center;
  }
  .swap-btn {
    background: var(--accent);
    border: 2px solid var(--border);
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all .2s;
    color: #fff;
    font-size: 1.4rem;
    font-weight: 700;
  }
  .swap-btn:hover {
    background: var(--accent2);
    transform: rotate(180deg);
  }

  .conv-result {
    background: var(--calc-display);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-top: 8px;
    min-height: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .conv-result-label {
    font-size: .72rem;
    text-transform: uppercase;
    letter-spacing: .12em;
    color: var(--muted);
    margin-bottom: 6px;
  }
  .conv-result-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.8rem;
    font-weight: 600;
    color: var(--green);
    word-break: break-all;
  }
  .conv-result-formula {
    font-size: .76rem;
    color: var(--muted);
    margin-top: 8px;
    font-family: 'JetBrains Mono', monospace;
  }

  .quick-conversions {
    margin-top: 24px;
    padding-top: 24px;
    border-top: 1px solid var(--border);
  }
  .quick-conversions h3 {
    font-size: .82rem;
    text-transform: uppercase;
    letter-spacing: .1em;
    color: var(--muted);
    margin-bottom: 12px;
  }
  .quick-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .quick-item {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: .84rem;
    font-family: 'JetBrains Mono', monospace;
    display: flex;
    justify-content: space-between;
  }
  .quick-item span:first-child { color: var(--muted); }
  .quick-item span:last-child { color: var(--text); font-weight: 500; }

  @media (max-width: 600px) {
    .app-header { padding: 16px 20px; }
    .app-header h1 { font-size: 1.3rem; }
    .main-nav { 
      padding: 0 12px; 
      top: 70px;
    }
    .main-nav button { 
      padding: 12px 12px; 
      font-size: .82rem;
    }
    .content { padding: 24px 16px; }
    .category-tabs { grid-template-columns: repeat(2, 1fr); }
    .calculator, .converter-card { padding: 20px; }
    .result, .conv-result-value { font-size: 1.4rem; }
    .calc-btn { padding: 14px 6px; font-size: .8rem; }
  }
</style>
</head>
<body>

<!-- APP HEADER -->
<div class="app-header">
  <h1>CalcHub</h1>
  <p>Your all-in-one calculation toolkit</p>
</div>

<!-- MAIN NAVIGATION -->
<div class="main-nav">
  <button class="main-nav-btn active" data-view="simple">‚ûï Simple</button>
  <button class="main-nav-btn" data-view="scientific">üî¨ Scientific</button>
  <button class="main-nav-btn" data-view="solver">üìê Solver</button>
  <button class="main-nav-btn" data-view="converter">üîÑ Converter</button>
  <button class="main-nav-btn" data-view="finance">üí∞ Finance</button>
  <button class="main-nav-btn" data-view="geometry">üìè Geometry</button>
  <button class="main-nav-btn" data-view="games">üéÆ Games</button>
  <button class="main-nav-btn" data-view="clock">üïê Clock</button>
</div>

<!-- CONTENT AREA -->
<div class="content">
  
  <!-- ========================================
       SIMPLE CALCULATOR VIEW
       ======================================== -->
  <div class="view active" id="simple">
    <div class="simple-calc-container">
      <div class="simple-calc">
        <div class="calc-header">
          <h2>Simple Calculator</h2>
          <p>Basic arithmetic operations</p>
        </div>

        <div class="simple-display">
          <div class="simple-expression" id="simpleExpression"></div>
          <div class="simple-result" id="simpleResult">0</div>
        </div>

        <div class="simple-buttons">
          <button class="simple-btn clear" data-simple-action="clear">C</button>
          <button class="simple-btn" data-simple-action="backspace">‚å´</button>
          <button class="simple-btn op" data-simple-action="percent">%</button>
          <button class="simple-btn op" data-simple-op="/">√∑</button>

          <button class="simple-btn" data-simple-num="7">7</button>
          <button class="simple-btn" data-simple-num="8">8</button>
          <button class="simple-btn" data-simple-num="9">9</button>
          <button class="simple-btn op" data-simple-op="*">√ó</button>

          <button class="simple-btn" data-simple-num="4">4</button>
          <button class="simple-btn" data-simple-num="5">5</button>
          <button class="simple-btn" data-simple-num="6">6</button>
          <button class="simple-btn op" data-simple-op="-">‚àí</button>

          <button class="simple-btn" data-simple-num="1">1</button>
          <button class="simple-btn" data-simple-num="2">2</button>
          <button class="simple-btn" data-simple-num="3">3</button>
          <button class="simple-btn op" data-simple-op="+">+</button>

          <button class="simple-btn zero" data-simple-num="0">0</button>
          <button class="simple-btn" data-simple-num=".">.</button>
          <button class="simple-btn equals" data-simple-action="equals">=</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       SCIENTIFIC CALCULATOR VIEW
       ======================================== -->
  <div class="view" id="scientific">
    <div class="calculator-container">
      <div class="calculator">
        <div class="calc-header">
          <h2>Scientific</h2>
          <p>Advanced Calculator</p>
        </div>

        <div class="display">
          <div class="expression" id="expression"></div>
          <div class="result" id="calcResult">0</div>
        </div>

        <div class="mode-toggle">
          <button id="btnDeg" class="active">Deg</button>
          <button id="btnRad">Rad</button>
        </div>

        <div class="buttons">
          <!-- row 1 -->
          <button class="calc-btn btn-function" data-fn="sin">sin</button>
          <button class="calc-btn btn-function" data-fn="cos">cos</button>
          <button class="calc-btn btn-function" data-fn="tan">tan</button>
          <button class="calc-btn btn-function" data-fn="log">log</button>
          <button class="calc-btn btn-function" data-fn="ln">ln</button>

          <!-- row 2 -->
          <button class="calc-btn btn-function" data-fn="sqrt">‚àö</button>
          <button class="calc-btn btn-function" data-fn="pow">x¬≤</button>
          <button class="calc-btn btn-function" data-fn="exp">eÀ£</button>
          <button class="calc-btn btn-function" data-fn="fact">x!</button>
          <button class="calc-btn btn-clear" data-action="clear">AC</button>

          <!-- row 3 -->
          <button class="calc-btn btn-function" data-const="pi">œÄ</button>
          <button class="calc-btn btn-function" data-const="e">e</button>
          <button class="calc-btn btn-operator" data-op="(">(</button>
          <button class="calc-btn btn-operator" data-op=")">)</button>
          <button class="calc-btn btn-operator" data-op="/">√∑</button>

          <!-- row 4 -->
          <button class="calc-btn" data-num="7">7</button>
          <button class="calc-btn" data-num="8">8</button>
          <button class="calc-btn" data-num="9">9</button>
          <button class="calc-btn btn-operator" data-op="*">√ó</button>
          <button class="calc-btn btn-function" data-fn="inv">1/x</button>

          <!-- row 5 -->
          <button class="calc-btn" data-num="4">4</button>
          <button class="calc-btn" data-num="5">5</button>
          <button class="calc-btn" data-num="6">6</button>
          <button class="calc-btn btn-operator" data-op="-">‚àí</button>
          <button class="calc-btn btn-function" data-fn="abs">|x|</button>

          <!-- row 6 -->
          <button class="calc-btn" data-num="1">1</button>
          <button class="calc-btn" data-num="2">2</button>
          <button class="calc-btn" data-num="3">3</button>
          <button class="calc-btn btn-operator" data-op="+">+</button>
          <button class="calc-btn btn-function" data-fn="neg">+/‚àí</button>

          <!-- row 7 -->
          <button class="calc-btn" data-num="0">0</button>
          <button class="calc-btn" data-num=".">.</button>
          <button class="calc-btn btn-operator" data-op="^">x ∏</button>
          <button class="calc-btn btn-equals" data-action="equals">=</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       CONVERTER VIEW
       ======================================== -->
  <div class="view" id="converter">
    <div class="converter-container">
      <div class="category-tabs">
        <button class="cat-tab active" data-category="length">Length</button>
        <button class="cat-tab" data-category="weight">Weight</button>
        <button class="cat-tab" data-category="volume">Volume</button>
        <button class="cat-tab" data-category="temp">Temp</button>
      </div>

      <div class="converter-card">
        <div class="converter">
          <!-- FROM -->
          <div class="unit-group">
            <label>From</label>
            <div class="input-row">
              <input type="number" id="inputValue" placeholder="Enter value" step="any" value="1" />
              <select id="fromUnit"></select>
            </div>
          </div>

          <!-- SWAP -->
          <div class="swap-row">
            <button class="swap-btn" id="swapBtn">‚áÖ</button>
          </div>

          <!-- TO -->
          <div class="unit-group">
            <label>To</label>
            <div class="input-row">
              <select id="toUnit"></select>
            </div>
          </div>

          <!-- RESULT -->
          <div class="conv-result">
            <div class="conv-result-label">Result</div>
            <div class="conv-result-value" id="convResultValue">‚Äî</div>
            <div class="conv-result-formula" id="convResultFormula"></div>
          </div>
        </div>

        <!-- QUICK CONVERSIONS -->
        <div class="quick-conversions">
          <h3>Common Conversions</h3>
          <div class="quick-list" id="quickList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       EQUATION SOLVER VIEW
       ======================================== -->
  <div class="view" id="solver">
    <div class="solver-container">
      <div class="solver-card">
        <div class="solver-header">
          <h2>Equation Solver</h2>
          <p>Enter an equation and solve for x<br/>
          <small style="opacity:.7">Use +, -, *, / for operations. Example: 2*x + 5 = 15</small></p>
        </div>

        <div class="equation-input-group">
          <label>Enter Equation</label>
          <input type="text" class="equation-input" id="equationInput" placeholder="e.g., 3*x - 7 = 14" />
        </div>

        <button class="solve-btn" id="solveBtn">Solve Equation</button>

        <div class="solution-box" id="solutionBox">
          <div class="solution-title">Solution</div>
          <div class="solution-result" id="solutionResult"></div>
          
          <div class="solution-steps">
            <h4>Step-by-Step Solution</h4>
            <div id="solutionSteps"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       FINANCE CALCULATOR VIEW
       ======================================== -->
  <div class="view" id="finance">
    <div class="finance-container">
      <div class="finance-tabs">
        <button class="finance-tab active" data-finance="interest">Interest</button>
        <button class="finance-tab" data-finance="tax">Tax</button>
        <button class="finance-tab" data-finance="tip">Tip</button>
        <button class="finance-tab" data-finance="discount">Discount</button>
      </div>

      <div class="finance-card">
        <!-- INTEREST CALCULATOR -->
        <div class="finance-section active" id="financeInterest">
          <div class="calc-header">
            <h2>Interest Calculator</h2>
            <p>Calculate simple & compound interest</p>
          </div>

          <div class="finance-input-group">
            <label>Principal Amount ($)</label>
            <input type="number" class="finance-input" id="principal" value="1000" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Interest Rate (%)</label>
            <input type="number" class="finance-input" id="interestRate" value="5" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Time Period (years)</label>
            <input type="number" class="finance-input" id="timePeriod" value="1" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Compound Frequency</label>
            <select class="finance-input" id="compoundFreq">
              <option value="1">Annually</option>
              <option value="2">Semi-annually</option>
              <option value="4">Quarterly</option>
              <option value="12">Monthly</option>
              <option value="365">Daily</option>
            </select>
          </div>

          <div class="finance-result-box">
            <div class="finance-result-label">Total Amount (Compound)</div>
            <div class="finance-result-value" id="interestTotal">$0.00</div>
            <div class="finance-breakdown">
              <div class="breakdown-item">
                <span>Principal</span>
                <span id="interestPrincipal">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>Interest Earned</span>
                <span id="interestEarned">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>Simple Interest</span>
                <span id="simpleInterest">$0.00</span>
              </div>
            </div>
          </div>
        </div>

        <!-- TAX CALCULATOR -->
        <div class="finance-section" id="financeTax">
          <div class="calc-header">
            <h2>Tax Calculator</h2>
            <p>Calculate sales tax and totals</p>
          </div>

          <div class="finance-input-group">
            <label>Price Before Tax ($)</label>
            <input type="number" class="finance-input" id="preTaxPrice" value="100" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Tax Rate (%)</label>
            <input type="number" class="finance-input" id="taxRate" value="8.5" step="any" />
          </div>

          <div class="finance-result-box">
            <div class="finance-result-label">Total with Tax</div>
            <div class="finance-result-value" id="taxTotal">$0.00</div>
            <div class="finance-breakdown">
              <div class="breakdown-item">
                <span>Subtotal</span>
                <span id="taxSubtotal">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>Tax Amount</span>
                <span id="taxAmount">$0.00</span>
              </div>
            </div>
          </div>
        </div>

        <!-- TIP CALCULATOR -->
        <div class="finance-section" id="financeTip">
          <div class="calc-header">
            <h2>Tip Calculator</h2>
            <p>Calculate tips and split bills</p>
          </div>

          <div class="finance-input-group">
            <label>Bill Amount ($)</label>
            <input type="number" class="finance-input" id="billAmount" value="50" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Tip Percentage (%)</label>
            <input type="number" class="finance-input" id="tipPercent" value="18" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Number of People</label>
            <input type="number" class="finance-input" id="numPeople" value="1" min="1" step="1" />
          </div>

          <div class="finance-result-box">
            <div class="finance-result-label">Total per Person</div>
            <div class="finance-result-value" id="tipPerPerson">$0.00</div>
            <div class="finance-breakdown">
              <div class="breakdown-item">
                <span>Bill Total</span>
                <span id="tipBillTotal">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>Tip Amount</span>
                <span id="tipAmountTotal">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>Grand Total</span>
                <span id="tipGrandTotal">$0.00</span>
              </div>
            </div>
          </div>
        </div>

        <!-- DISCOUNT CALCULATOR -->
        <div class="finance-section" id="financeDiscount">
          <div class="calc-header">
            <h2>Discount Calculator</h2>
            <p>Calculate sale prices and savings</p>
          </div>

          <div class="finance-input-group">
            <label>Original Price ($)</label>
            <input type="number" class="finance-input" id="originalPrice" value="100" step="any" />
          </div>

          <div class="finance-input-group">
            <label>Discount (%)</label>
            <input type="number" class="finance-input" id="discountPercent" value="25" step="any" />
          </div>

          <div class="finance-result-box">
            <div class="finance-result-label">Final Price</div>
            <div class="finance-result-value" id="discountFinal">$0.00</div>
            <div class="finance-breakdown">
              <div class="breakdown-item">
                <span>Original Price</span>
                <span id="discountOriginal">$0.00</span>
              </div>
              <div class="breakdown-item">
                <span>You Save</span>
                <span id="discountSavings">$0.00</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       GEOMETRY CALCULATOR VIEW
       ======================================== -->
  <div class="view" id="geometry">
    <div class="geometry-container">
      <div class="geometry-tabs">
        <button class="geometry-tab active" data-shape="circle">Circle</button>
        <button class="geometry-tab" data-shape="triangle">Triangle</button>
        <button class="geometry-tab" data-shape="rectangle">Rectangle</button>
        <button class="geometry-tab" data-shape="square">Square</button>
        <button class="geometry-tab" data-shape="trapezoid">Trapezoid</button>
        <button class="geometry-tab" data-shape="cylinder">Cylinder</button>
      </div>

      <div class="geometry-card">
        <!-- CIRCLE -->
        <div class="geometry-section active" id="shapeCircle">
          <div class="geometry-header">
            <h3>Circle</h3>
            <p>Calculate area, circumference, diameter, and radius</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="160" height="160" viewBox="0 0 160 160">
              <circle cx="80" cy="80" r="60" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <line x1="80" y1="80" x2="140" y2="80" stroke="#4ade80" stroke-width="2"/>
              <text x="110" y="75" fill="#4ade80" font-size="12" font-family="monospace">r</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Radius (r)</label>
              <input type="number" class="geometry-input" id="circleRadius" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Diameter (d)</label>
              <input type="number" class="geometry-input" id="circleDiameter" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Area</div>
                <div class="formula-hint">œÄ √ó r¬≤</div>
              </div>
              <div class="geometry-result-value" id="circleArea">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Circumference</div>
                <div class="formula-hint">2 √ó œÄ √ó r</div>
              </div>
              <div class="geometry-result-value" id="circleCircumference">0</div>
            </div>
            <div class="geometry-result-item">
              <div class="geometry-result-label">Diameter</div>
              <div class="geometry-result-value" id="circleDiameterResult">0</div>
            </div>
            <div class="geometry-result-item">
              <div class="geometry-result-label">Radius</div>
              <div class="geometry-result-value" id="circleRadiusResult">0</div>
            </div>
          </div>
        </div>

        <!-- TRIANGLE -->
        <div class="geometry-section" id="shapeTriangle">
          <div class="geometry-header">
            <h3>Triangle</h3>
            <p>Calculate area, perimeter, and angles</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="180" height="160" viewBox="0 0 180 160">
              <polygon points="90,20 20,140 160,140" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <text x="85" y="90" fill="#4ade80" font-size="12" font-family="monospace">h</text>
              <text x="85" y="155" fill="#4ade80" font-size="12" font-family="monospace">b</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Base (b)</label>
              <input type="number" class="geometry-input" id="triangleBase" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Height (h)</label>
              <input type="number" class="geometry-input" id="triangleHeight" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Side A</label>
              <input type="number" class="geometry-input" id="triangleSideA" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Side B</label>
              <input type="number" class="geometry-input" id="triangleSideB" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Side C</label>
              <input type="number" class="geometry-input" id="triangleSideC" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Area</div>
                <div class="formula-hint">¬Ω √ó b √ó h</div>
              </div>
              <div class="geometry-result-value" id="triangleArea">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Perimeter</div>
                <div class="formula-hint">a + b + c</div>
              </div>
              <div class="geometry-result-value" id="trianglePerimeter">0</div>
            </div>
          </div>
        </div>

        <!-- RECTANGLE -->
        <div class="geometry-section" id="shapeRectangle">
          <div class="geometry-header">
            <h3>Rectangle</h3>
            <p>Calculate area, perimeter, and diagonal</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="200" height="140" viewBox="0 0 200 140">
              <rect x="30" y="30" width="140" height="80" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <text x="95" y="25" fill="#4ade80" font-size="12" font-family="monospace">w</text>
              <text x="15" y="75" fill="#4ade80" font-size="12" font-family="monospace">h</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Width (w)</label>
              <input type="number" class="geometry-input" id="rectangleWidth" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Height (h)</label>
              <input type="number" class="geometry-input" id="rectangleHeight" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Area</div>
                <div class="formula-hint">w √ó h</div>
              </div>
              <div class="geometry-result-value" id="rectangleArea">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Perimeter</div>
                <div class="formula-hint">2 √ó (w + h)</div>
              </div>
              <div class="geometry-result-value" id="rectanglePerimeter">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Diagonal</div>
                <div class="formula-hint">‚àö(w¬≤ + h¬≤)</div>
              </div>
              <div class="geometry-result-value" id="rectangleDiagonal">0</div>
            </div>
          </div>
        </div>

        <!-- SQUARE -->
        <div class="geometry-section" id="shapeSquare">
          <div class="geometry-header">
            <h3>Square</h3>
            <p>Calculate area, perimeter, and diagonal</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="160" height="160" viewBox="0 0 160 160">
              <rect x="30" y="30" width="100" height="100" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <text x="75" y="25" fill="#4ade80" font-size="12" font-family="monospace">s</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Side (s)</label>
              <input type="number" class="geometry-input" id="squareSide" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Area</div>
                <div class="formula-hint">s¬≤</div>
              </div>
              <div class="geometry-result-value" id="squareArea">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Perimeter</div>
                <div class="formula-hint">4 √ó s</div>
              </div>
              <div class="geometry-result-value" id="squarePerimeter">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Diagonal</div>
                <div class="formula-hint">s √ó ‚àö2</div>
              </div>
              <div class="geometry-result-value" id="squareDiagonal">0</div>
            </div>
          </div>
        </div>

        <!-- TRAPEZOID -->
        <div class="geometry-section" id="shapeTrapezoid">
          <div class="geometry-header">
            <h3>Trapezoid</h3>
            <p>Calculate area and perimeter</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="200" height="160" viewBox="0 0 200 160">
              <polygon points="50,30 150,30 180,130 20,130" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <text x="95" y="25" fill="#4ade80" font-size="12" font-family="monospace">a</text>
              <text x="95" y="145" fill="#4ade80" font-size="12" font-family="monospace">b</text>
              <text x="185" y="80" fill="#4ade80" font-size="12" font-family="monospace">h</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Base A (a)</label>
              <input type="number" class="geometry-input" id="trapezoidBaseA" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Base B (b)</label>
              <input type="number" class="geometry-input" id="trapezoidBaseB" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Height (h)</label>
              <input type="number" class="geometry-input" id="trapezoidHeight" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Side C</label>
              <input type="number" class="geometry-input" id="trapezoidSideC" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Side D</label>
              <input type="number" class="geometry-input" id="trapezoidSideD" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Area</div>
                <div class="formula-hint">¬Ω √ó (a + b) √ó h</div>
              </div>
              <div class="geometry-result-value" id="trapezoidArea">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Perimeter</div>
                <div class="formula-hint">a + b + c + d</div>
              </div>
              <div class="geometry-result-value" id="trapezoidPerimeter">0</div>
            </div>
          </div>
        </div>

        <!-- CYLINDER -->
        <div class="geometry-section" id="shapeCylinder">
          <div class="geometry-header">
            <h3>Cylinder</h3>
            <p>Calculate volume and surface area</p>
          </div>

          <div class="geometry-visual">
            <svg class="shape-svg" width="160" height="180" viewBox="0 0 160 180">
              <ellipse cx="80" cy="40" rx="50" ry="15" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <line x1="30" y1="40" x2="30" y2="140" stroke="#5b9eff" stroke-width="3"/>
              <line x1="130" y1="40" x2="130" y2="140" stroke="#5b9eff" stroke-width="3"/>
              <ellipse cx="80" cy="140" rx="50" ry="15" fill="none" stroke="#5b9eff" stroke-width="3"/>
              <text x="85" y="95" fill="#4ade80" font-size="12" font-family="monospace">h</text>
              <text x="105" y="35" fill="#4ade80" font-size="12" font-family="monospace">r</text>
            </svg>
          </div>

          <div class="geometry-inputs">
            <div class="geometry-input-group">
              <label>Radius (r)</label>
              <input type="number" class="geometry-input" id="cylinderRadius" placeholder="0" step="any" />
            </div>
            <div class="geometry-input-group">
              <label>Height (h)</label>
              <input type="number" class="geometry-input" id="cylinderHeight" placeholder="0" step="any" />
            </div>
          </div>

          <div class="geometry-results">
            <h4>Results</h4>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Volume</div>
                <div class="formula-hint">œÄ √ó r¬≤ √ó h</div>
              </div>
              <div class="geometry-result-value" id="cylinderVolume">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Surface Area</div>
                <div class="formula-hint">2œÄr(r + h)</div>
              </div>
              <div class="geometry-result-value" id="cylinderSurface">0</div>
            </div>
            <div class="geometry-result-item">
              <div>
                <div class="geometry-result-label">Lateral Area</div>
                <div class="formula-hint">2 √ó œÄ √ó r √ó h</div>
              </div>
              <div class="geometry-result-value" id="cylinderLateral">0</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================================
       MATH GAMES VIEW
       ======================================== -->
  <div class="view" id="games">
    <div class="games-container">
      
      <!-- Game Setup Screen -->
      <div class="game-setup" id="gameSetup">
        <h2>üéÆ Math Games</h2>
        <p>Choose your grade level and game mode to start playing!</p>

        <div class="grade-selector">
          <label>Select Grade Level</label>
          <div class="grade-buttons">
            <button class="grade-btn" data-grade="1">1st</button>
            <button class="grade-btn" data-grade="2">2nd</button>
            <button class="grade-btn" data-grade="3">3rd</button>
            <button class="grade-btn" data-grade="4">4th</button>
            <button class="grade-btn" data-grade="5">5th</button>
            <button class="grade-btn" data-grade="6">6th</button>
            <button class="grade-btn" data-grade="7">7th</button>
            <button class="grade-btn" data-grade="8">8th</button>
            <button class="grade-btn" data-grade="9">9th</button>
            <button class="grade-btn" data-grade="10">10th</button>
            <button class="grade-btn" data-grade="11">11th</button>
            <button class="grade-btn" data-grade="12">12th</button>
          </div>
        </div>

        <div class="game-mode-selector">
          <label>Select Game Mode</label>
          <div class="game-mode-buttons">
            <button class="game-mode-btn" data-mode="speed">
              <span class="mode-icon">‚ö°</span>
              <span class="mode-name">Speed Round</span>
              <span class="mode-desc">60 seconds, max questions</span>
            </button>
            <button class="game-mode-btn" data-mode="accuracy">
              <span class="mode-icon">üéØ</span>
              <span class="mode-name">Accuracy</span>
              <span class="mode-desc">10 questions, no timer</span>
            </button>
            <button class="game-mode-btn" data-mode="challenge">
              <span class="mode-icon">üèÜ</span>
              <span class="mode-name">Challenge</span>
              <span class="mode-desc">20 questions, 3 lives</span>
            </button>
            <button class="game-mode-btn" data-mode="practice">
              <span class="mode-icon">üìö</span>
              <span class="mode-name">Practice</span>
              <span class="mode-desc">Endless, no pressure</span>
            </button>
          </div>
        </div>

        <button class="start-game-btn" id="startGameBtn" disabled>Start Game</button>
      </div>

      <!-- Game Play Screen -->
      <div class="game-play" id="gamePlay">
        <div class="game-header-bar">
          <div class="game-stat">
            <div class="game-stat-label">Score</div>
            <div class="game-stat-value" id="gameScore">0</div>
          </div>
          <div class="game-stat" id="timerStat" style="display:none;">
            <div class="game-stat-label">Time</div>
            <div class="game-stat-value timer-value" id="gameTimer">60</div>
          </div>
          <div class="game-stat" id="questionStat">
            <div class="game-stat-label">Question</div>
            <div class="game-stat-value" id="gameQuestion">1/10</div>
          </div>
          <div class="game-stat" id="livesStat" style="display:none;">
            <div class="game-stat-label">Lives</div>
            <div class="game-stat-value" id="gameLives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
          </div>
          <button class="game-btn secondary" id="quitGameBtn">Quit</button>
        </div>

        <div class="game-content" id="gameContent">
          <!-- Dynamic content based on question type -->
        </div>
      </div>

    </div>
  </div>

  <!-- ========================================
       ANALOG CLOCK VIEW
       ======================================== -->
  <div class="view" id="clock">
    <div class="clock-container">
      <div class="clock-card">
        <div class="clock-header">
          <h2>Analog Clock Reader</h2>
          <p>Drag the clock hands to learn time</p>
        </div>

        <div class="analog-clock" id="analogClock">
          <div class="clock-center"></div>
          <div class="hour-hand hand" id="hourHand"></div>
          <div class="minute-hand hand" id="minuteHand"></div>
        </div>

        <div class="time-display">
          <div class="digital-time" id="digitalTime">12:00</div>
          <div class="time-description" id="timeDescription">Twelve o'clock</div>
        </div>

        <div class="clock-controls">
          <button class="clock-btn primary" id="setCurrentTime">Set Current Time</button>
          <button class="clock-btn secondary" id="randomTime">Random Time</button>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
(function () {
  // ========================================
  // MAIN APP NAVIGATION
  // ========================================
  document.querySelectorAll('.main-nav-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelector('.main-nav-btn.active').classList.remove('active');
      btn.classList.add('active');
      
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.getElementById(btn.dataset.view).classList.add('active');
    });
  });

  // ========================================
  // SIMPLE CALCULATOR LOGIC
  // ========================================
  const simpleExpressionEl = document.getElementById('simpleExpression');
  const simpleResultEl = document.getElementById('simpleResult');
  let simpleExpr = '';
  let simpleLastResult = '';

  document.querySelector('.simple-buttons').addEventListener('click', (e) => {
    const btn = e.target.closest('button');
    if (!btn) return;

    if (btn.dataset.simpleNum !== undefined) {
      simpleExpr += btn.dataset.simpleNum;
      updateSimpleDisplay();
    } else if (btn.dataset.simpleOp) {
      if (simpleExpr && !/[\+\-\*\/]$/.test(simpleExpr)) {
        simpleExpr += btn.dataset.simpleOp;
        updateSimpleDisplay();
      }
    } else if (btn.dataset.simpleAction === 'clear') {
      simpleExpr = '';
      simpleLastResult = '';
      updateSimpleDisplay();
      simpleResultEl.textContent = '0';
    } else if (btn.dataset.simpleAction === 'backspace') {
      simpleExpr = simpleExpr.slice(0, -1);
      updateSimpleDisplay();
    } else if (btn.dataset.simpleAction === 'percent') {
      if (simpleExpr) {
        try {
          const val = evaluateSimple(simpleExpr);
          simpleExpr = String(val / 100);
          updateSimpleDisplay();
          simpleResultEl.textContent = formatSimpleNumber(val / 100);
        } catch (e) {}
      }
    } else if (btn.dataset.simpleAction === 'equals') {
      calculateSimple();
    }
  });

  function updateSimpleDisplay() {
    simpleExpressionEl.textContent = simpleExpr || '';
  }

  function calculateSimple() {
    if (!simpleExpr.trim()) return;
    try {
      const result = evaluateSimple(simpleExpr);
      simpleResultEl.textContent = formatSimpleNumber(result);
      simpleResultEl.classList.remove('error');
      simpleLastResult = String(result);
    } catch (err) {
      simpleResultEl.textContent = 'Error';
      simpleResultEl.classList.add('error');
    }
  }

  function evaluateSimple(expr) {
    // Simple eval with PEMDAS support
    const result = Function('"use strict"; return (' + expr + ')')();
    if (!isFinite(result)) throw new Error('Invalid');
    return result;
  }

  function formatSimpleNumber(num) {
    const rounded = Math.round(num * 1e10) / 1e10;
    if (Number.isInteger(rounded)) return String(rounded);
    if (Math.abs(rounded) > 1e9) return rounded.toExponential(4);
    return String(rounded);
  }

  // ========================================
  // SCIENTIFIC CALCULATOR LOGIC
  // ========================================
  const expressionEl = document.getElementById('expression');
  const calcResultEl = document.getElementById('calcResult');
  const btnDeg       = document.getElementById('btnDeg');
  const btnRad       = document.getElementById('btnRad');

  let expression = '';
  let angleMode  = 'deg';

  btnDeg.addEventListener('click', () => { 
    angleMode = 'deg'; 
    btnDeg.classList.add('active'); 
    btnRad.classList.remove('active'); 
  });
  btnRad.addEventListener('click', () => { 
    angleMode = 'rad'; 
    btnRad.classList.add('active'); 
    btnDeg.classList.remove('active'); 
  });

  document.querySelector('.buttons').addEventListener('click', (e) => {
    const btn = e.target.closest('button');
    if (!btn) return;

    if (btn.dataset.num !== undefined) {
      appendToExpression(btn.dataset.num);
    } else if (btn.dataset.op) {
      appendToExpression(btn.dataset.op);
    } else if (btn.dataset.const) {
      if (btn.dataset.const === 'pi') appendToExpression('œÄ');
      if (btn.dataset.const === 'e')  appendToExpression('e');
    } else if (btn.dataset.fn) {
      handleFunction(btn.dataset.fn);
    } else if (btn.dataset.action === 'clear') {
      clearAll();
    } else if (btn.dataset.action === 'equals') {
      calculate();
    }
  });

  function appendToExpression(val) {
    expression += val;
    updateDisplay();
  }

  function handleFunction(fn) {
    switch (fn) {
      case 'sin':
      case 'cos':
      case 'tan':
      case 'log':
      case 'ln':
      case 'sqrt':
        expression += fn + '(';
        break;
      case 'pow':   expression += '^2';      break;
      case 'exp':   expression += 'e^';      break;
      case 'fact':  expression += '!';       break;
      case 'inv':   expression += '^(-1)';   break;
      case 'abs':   expression += 'abs(';    break;
      case 'neg':
        expression = toggleSign(expression);
        break;
    }
    updateDisplay();
  }

  function toggleSign(expr) {
    const trimmed = expr.trim();
    if (!trimmed) return expr;
    const last = trimmed[trimmed.length - 1];
    if (/[\d\)]/.test(last)) return expr + '*(-1)';
    return expr;
  }

  function clearAll() {
    expression = '';
    updateDisplay();
    calcResultEl.textContent = '0';
    calcResultEl.classList.remove('error');
  }

  function updateDisplay() {
    expressionEl.textContent = expression || '';
  }

  function calculate() {
    if (!expression.trim()) return;
    try {
      const result = evaluateExpression(expression);
      calcResultEl.textContent = formatNumber(result);
      calcResultEl.classList.remove('error');
    } catch (err) {
      calcResultEl.textContent = 'Error';
      calcResultEl.classList.add('error');
    }
  }

  function evaluateExpression(expr) {
    expr = expr.replace(/œÄ/g, Math.PI);
    expr = expr.replace(/e(?![a-z])/g, Math.E);

    expr = expr.replace(/sin\(/g, angleMode === 'deg' ? '_sin(' : 'Math.sin(');
    expr = expr.replace(/cos\(/g, angleMode === 'deg' ? '_cos(' : 'Math.cos(');
    expr = expr.replace(/tan\(/g, angleMode === 'deg' ? '_tan(' : 'Math.tan(');
    expr = expr.replace(/log\(/g, '_log(');
    expr = expr.replace(/ln\(/g, 'Math.log(');
    expr = expr.replace(/sqrt\(/g, 'Math.sqrt(');
    expr = expr.replace(/abs\(/g, 'Math.abs(');
    expr = expr.replace(/(\d+)!/g, '_fact($1)');
    expr = expr.replace(/\^/g, '**');

    const _sin  = (x) => Math.sin(x * Math.PI / 180);
    const _cos  = (x) => Math.cos(x * Math.PI / 180);
    const _tan  = (x) => Math.tan(x * Math.PI / 180);
    const _log  = (x) => Math.log10(x);
    const _fact = (n) => {
      n = Math.floor(n);
      if (n < 0) throw new Error('Factorial of negative');
      if (n === 0 || n === 1) return 1;
      let res = 1;
      for (let i = 2; i <= n; i++) res *= i;
      return res;
    };

    const result = Function('"use strict"; return (' + expr + ')')();
    if (!isFinite(result)) throw new Error('Infinite or NaN');
    return result;
  }

  function formatNumber(num) {
    const rounded = Math.round(num * 1e10) / 1e10;
    if (Number.isInteger(rounded)) return String(rounded);
    if (Math.abs(rounded) > 1e9 || (Math.abs(rounded) < 1e-6 && rounded !== 0)) {
      return rounded.toExponential(6);
    }
    return String(rounded);
  }

  document.addEventListener('keydown', (e) => {
    const activeView = document.querySelector('.view.active').id;
    
    if (activeView === 'simple') {
      if (e.key >= '0' && e.key <= '9') { simpleExpr += e.key; updateSimpleDisplay(); }
      else if (e.key === '.') { simpleExpr += '.'; updateSimpleDisplay(); }
      else if (e.key === '+') { simpleExpr += '+'; updateSimpleDisplay(); }
      else if (e.key === '-') { simpleExpr += '-'; updateSimpleDisplay(); }
      else if (e.key === '*') { simpleExpr += '*'; updateSimpleDisplay(); }
      else if (e.key === '/') { simpleExpr += '/'; updateSimpleDisplay(); }
      else if (e.key === 'Enter' || e.key === '=') calculateSimple();
      else if (e.key === 'Escape' || e.key === 'Delete') {
        simpleExpr = ''; simpleLastResult = ''; updateSimpleDisplay(); simpleResultEl.textContent = '0';
      }
      else if (e.key === 'Backspace') { simpleExpr = simpleExpr.slice(0, -1); updateSimpleDisplay(); }
    } else if (activeView === 'scientific') {
      if (e.key >= '0' && e.key <= '9') appendToExpression(e.key);
      else if (e.key === '.') appendToExpression('.');
      else if (e.key === '+') appendToExpression('+');
      else if (e.key === '-') appendToExpression('-');
      else if (e.key === '*') appendToExpression('*');
      else if (e.key === '/') appendToExpression('/');
      else if (e.key === '(') appendToExpression('(');
      else if (e.key === ')') appendToExpression(')');
      else if (e.key === '^') appendToExpression('^');
      else if (e.key === 'Enter' || e.key === '=') calculate();
      else if (e.key === 'Escape' || e.key === 'Delete') clearAll();
      else if (e.key === 'Backspace') {
        expression = expression.slice(0, -1);
        updateDisplay();
      }
    }
  });

  // ========================================
  // EQUATION SOLVER LOGIC
  // ========================================
  const equationInput = document.getElementById('equationInput');
  const solveBtn = document.getElementById('solveBtn');
  const solutionBox = document.getElementById('solutionBox');
  const solutionResult = document.getElementById('solutionResult');
  const solutionSteps = document.getElementById('solutionSteps');

  solveBtn.addEventListener('click', solveEquation);
  equationInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') solveEquation();
  });

  function solveEquation() {
    const equation = equationInput.value.trim();
    if (!equation) return;

    try {
      // Parse equation (format: expression = value)
      if (!equation.includes('=')) {
        throw new Error('Equation must contain an equals sign (=)');
      }

      const [leftSide, rightSide] = equation.split('=').map(s => s.trim());
      
      // Simple linear equation solver (handles ax + b = c format)
      const solution = solveLinearEquation(leftSide, rightSide);
      
      solutionResult.textContent = `x = ${solution.toFixed(4)}`;
      solutionBox.classList.add('visible');
      
      // Generate steps
      generateSolutionSteps(leftSide, rightSide, solution);
    } catch (error) {
      solutionResult.textContent = 'Error: ' + error.message;
      solutionBox.classList.add('visible');
      solutionSteps.innerHTML = '';
    }
  }

  function solveLinearEquation(left, right) {
    // Move everything to left side: left - right = 0
    // Then solve for x
    
    // Evaluate right side first (should be a number)
    const rightValue = evaluateSimple(right.replace(/x/gi, '0'));
    
    // Try different x values and use numerical methods
    // For simple cases, try to isolate x algebraically
    
    // Test if it's simple format like "2*x + 5" or "3*x - 7"
    const terms = left.match(/([+-]?\d*\.?\d*)\*?x|([+-]?\d+\.?\d*)/g) || [];
    
    let xCoeff = 0;
    let constant = 0;
    
    for (let term of terms) {
      if (term.includes('x')) {
        // Extract coefficient
        let coef = term.replace(/\*?x/gi, '').trim();
        if (coef === '' || coef === '+') coef = '1';
        if (coef === '-') coef = '-1';
        xCoeff += parseFloat(coef);
      } else {
        constant += parseFloat(term);
      }
    }
    
    // Solve: xCoeff * x + constant = rightValue
    // x = (rightValue - constant) / xCoeff
    if (xCoeff === 0) throw new Error('No variable x found or equation is not linear');
    
    return (rightValue - constant) / xCoeff;
  }

  function generateSolutionSteps(left, right, solution) {
    const steps = [];
    steps.push(`Original equation: ${left} = ${right}`);
    steps.push(`Isolate the variable x`);
    steps.push(`Solve for x algebraically`);
    steps.push(`Solution: x = ${solution.toFixed(4)}`);
    
    // Verify
    const verification = left.replace(/x/gi, solution);
    try {
      const result = evaluateSimple(verification);
      const rightValue = evaluateSimple(right);
      steps.push(`Verification: ${result.toFixed(4)} ‚âà ${rightValue.toFixed(4)}`);
    } catch (e) {}
    
    solutionSteps.innerHTML = steps.map((step, i) => 
      `<div class="step"><span class="step-num">${i + 1}.</span>${step}</div>`
    ).join('');
  }

  // ========================================
  // FINANCE CALCULATORS LOGIC
  // ========================================
  
  // Finance tab switching
  document.querySelectorAll('.finance-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelector('.finance-tab.active').classList.remove('active');
      tab.classList.add('active');
      
      document.querySelectorAll('.finance-section').forEach(section => section.classList.remove('active'));
      document.getElementById('finance' + tab.dataset.finance.charAt(0).toUpperCase() + tab.dataset.finance.slice(1)).classList.add('active');
    });
  });

  // Interest Calculator
  const principal = document.getElementById('principal');
  const interestRate = document.getElementById('interestRate');
  const timePeriod = document.getElementById('timePeriod');
  const compoundFreq = document.getElementById('compoundFreq');

  [principal, interestRate, timePeriod, compoundFreq].forEach(input => {
    input.addEventListener('input', calculateInterest);
  });

  function calculateInterest() {
    const P = parseFloat(principal.value) || 0;
    const r = parseFloat(interestRate.value) / 100 || 0;
    const t = parseFloat(timePeriod.value) || 0;
    const n = parseFloat(compoundFreq.value) || 1;

    // Compound Interest: A = P(1 + r/n)^(nt)
    const compoundAmount = P * Math.pow(1 + r/n, n*t);
    const compoundInterest = compoundAmount - P;

    // Simple Interest: I = Prt
    const simpleInterestAmount = P * r * t;

    document.getElementById('interestTotal').textContent = '$' + compoundAmount.toFixed(2);
    document.getElementById('interestPrincipal').textContent = '$' + P.toFixed(2);
    document.getElementById('interestEarned').textContent = '$' + compoundInterest.toFixed(2);
    document.getElementById('simpleInterest').textContent = '$' + simpleInterestAmount.toFixed(2);
  }

  // Tax Calculator
  const preTaxPrice = document.getElementById('preTaxPrice');
  const taxRate = document.getElementById('taxRate');

  [preTaxPrice, taxRate].forEach(input => {
    input.addEventListener('input', calculateTax);
  });

  function calculateTax() {
    const price = parseFloat(preTaxPrice.value) || 0;
    const rate = parseFloat(taxRate.value) / 100 || 0;
    
    const taxAmount = price * rate;
    const total = price + taxAmount;

    document.getElementById('taxTotal').textContent = '$' + total.toFixed(2);
    document.getElementById('taxSubtotal').textContent = '$' + price.toFixed(2);
    document.getElementById('taxAmount').textContent = '$' + taxAmount.toFixed(2);
  }

  // Tip Calculator
  const billAmount = document.getElementById('billAmount');
  const tipPercent = document.getElementById('tipPercent');
  const numPeople = document.getElementById('numPeople');

  [billAmount, tipPercent, numPeople].forEach(input => {
    input.addEventListener('input', calculateTip);
  });

  function calculateTip() {
    const bill = parseFloat(billAmount.value) || 0;
    const tip = parseFloat(tipPercent.value) / 100 || 0;
    const people = parseFloat(numPeople.value) || 1;

    const tipAmount = bill * tip;
    const total = bill + tipAmount;
    const perPerson = total / people;

    document.getElementById('tipPerPerson').textContent = '$' + perPerson.toFixed(2);
    document.getElementById('tipBillTotal').textContent = '$' + bill.toFixed(2);
    document.getElementById('tipAmountTotal').textContent = '$' + tipAmount.toFixed(2);
    document.getElementById('tipGrandTotal').textContent = '$' + total.toFixed(2);
  }

  // Discount Calculator
  const originalPrice = document.getElementById('originalPrice');
  const discountPercent = document.getElementById('discountPercent');

  [originalPrice, discountPercent].forEach(input => {
    input.addEventListener('input', calculateDiscount);
  });

  function calculateDiscount() {
    const price = parseFloat(originalPrice.value) || 0;
    const discount = parseFloat(discountPercent.value) / 100 || 0;

    const savings = price * discount;
    const final = price - savings;

    document.getElementById('discountFinal').textContent = '$' + final.toFixed(2);
    document.getElementById('discountOriginal').textContent = '$' + price.toFixed(2);
    document.getElementById('discountSavings').textContent = '$' + savings.toFixed(2);
  }

  // Initialize finance calculators
  calculateInterest();
  calculateTax();
  calculateTip();
  calculateDiscount();

  // ========================================
  // ANALOG CLOCK LOGIC
  // ========================================
  const analogClock = document.getElementById('analogClock');
  const hourHand = document.getElementById('hourHand');
  const minuteHand = document.getElementById('minuteHand');
  const digitalTime = document.getElementById('digitalTime');
  const timeDescription = document.getElementById('timeDescription');
  const setCurrentTimeBtn = document.getElementById('setCurrentTime');
  const randomTimeBtn = document.getElementById('randomTime');

  let currentHour = 12;
  let currentMinute = 0;

  // Add clock numbers
  for (let i = 1; i <= 12; i++) {
    const num = document.createElement('div');
    num.className = 'clock-number';
    num.textContent = i;
    const angle = (i * 30 - 90) * Math.PI / 180;
    const radius = 130;
    num.style.left = (150 + radius * Math.cos(angle) - 15) + 'px';
    num.style.top = (150 + radius * Math.sin(angle) - 15) + 'px';
    analogClock.appendChild(num);
  }

  // Draggable hands
  let isDragging = false;
  let currentHand = null;

  function startDrag(e, hand) {
    isDragging = true;
    currentHand = hand;
    e.preventDefault();
  }

  function drag(e) {
    if (!isDragging) return;
    
    const rect = analogClock.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    
    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
    
    const angle = Math.atan2(clientY - centerY, clientX - centerX);
    let degrees = angle * 180 / Math.PI + 90;
    if (degrees < 0) degrees += 360;

    if (currentHand === 'hour') {
      currentHour = Math.round(degrees / 30);
      if (currentHour === 0) currentHour = 12;
    } else if (currentHand === 'minute') {
      currentMinute = Math.round(degrees / 6);
      if (currentMinute === 60) currentMinute = 0;
    }

    updateClock();
  }

  function stopDrag() {
    isDragging = false;
    currentHand = null;
  }

  hourHand.addEventListener('mousedown', (e) => startDrag(e, 'hour'));
  minuteHand.addEventListener('mousedown', (e) => startDrag(e, 'minute'));
  hourHand.addEventListener('touchstart', (e) => startDrag(e, 'hour'));
  minuteHand.addEventListener('touchstart', (e) => startDrag(e, 'minute'));
  
  document.addEventListener('mousemove', drag);
  document.addEventListener('touchmove', drag);
  document.addEventListener('mouseup', stopDrag);
  document.addEventListener('touchend', stopDrag);

  function updateClock() {
    const hourAngle = (currentHour % 12) * 30 + currentMinute * 0.5;
    const minuteAngle = currentMinute * 6;

    hourHand.style.transform = `rotate(${hourAngle}deg)`;
    minuteHand.style.transform = `rotate(${minuteAngle}deg)`;

    const hour12 = currentHour === 0 ? 12 : currentHour;
    const ampm = currentHour >= 12 ? 'PM' : 'AM';
    const displayHour = hour12 > 12 ? hour12 - 12 : hour12;
    
    digitalTime.textContent = `${displayHour}:${String(currentMinute).padStart(2, '0')}`;
    timeDescription.textContent = describeTime(displayHour, currentMinute);
  }

  function describeTime(hour, minute) {
    const hourNames = ['twelve', 'one', 'two', 'three', 'four', 'five', 'six', 
                       'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve'];
    
    if (minute === 0) return `${hourNames[hour]} o'clock`;
    if (minute === 15) return `quarter past ${hourNames[hour]}`;
    if (minute === 30) return `half past ${hourNames[hour]}`;
    if (minute === 45) return `quarter to ${hourNames[hour + 1] || 'one'}`;
    if (minute < 30) return `${minute} minutes past ${hourNames[hour]}`;
    return `${60 - minute} minutes to ${hourNames[hour + 1] || 'one'}`;
  }

  setCurrentTimeBtn.addEventListener('click', () => {
    const now = new Date();
    currentHour = now.getHours();
    currentMinute = now.getMinutes();
    updateClock();
  });

  randomTimeBtn.addEventListener('click', () => {
    currentHour = Math.floor(Math.random() * 12) + 1;
    currentMinute = Math.floor(Math.random() * 60);
    updateClock();
  });

  // Initialize clock
  updateClock();

  // ========================================
  // GEOMETRY CALCULATOR LOGIC
  // ========================================
  
  // Geometry tab switching
  document.querySelectorAll('.geometry-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelector('.geometry-tab.active').classList.remove('active');
      tab.classList.add('active');
      
      document.querySelectorAll('.geometry-section').forEach(section => section.classList.remove('active'));
      document.getElementById('shape' + tab.dataset.shape.charAt(0).toUpperCase() + tab.dataset.shape.slice(1)).classList.add('active');
    });
  });

  // CIRCLE
  const circleRadius = document.getElementById('circleRadius');
  const circleDiameter = document.getElementById('circleDiameter');

  circleRadius.addEventListener('input', () => {
    const r = parseFloat(circleRadius.value) || 0;
    circleDiameter.value = r * 2;
    calculateCircle(r);
  });

  circleDiameter.addEventListener('input', () => {
    const d = parseFloat(circleDiameter.value) || 0;
    circleRadius.value = d / 2;
    calculateCircle(d / 2);
  });

  function calculateCircle(r) {
    const area = Math.PI * r * r;
    const circumference = 2 * Math.PI * r;
    const diameter = r * 2;

    document.getElementById('circleArea').textContent = area.toFixed(2);
    document.getElementById('circleCircumference').textContent = circumference.toFixed(2);
    document.getElementById('circleDiameterResult').textContent = diameter.toFixed(2);
    document.getElementById('circleRadiusResult').textContent = r.toFixed(2);
  }

  // TRIANGLE
  const triangleBase = document.getElementById('triangleBase');
  const triangleHeight = document.getElementById('triangleHeight');
  const triangleSideA = document.getElementById('triangleSideA');
  const triangleSideB = document.getElementById('triangleSideB');
  const triangleSideC = document.getElementById('triangleSideC');

  [triangleBase, triangleHeight, triangleSideA, triangleSideB, triangleSideC].forEach(input => {
    input.addEventListener('input', calculateTriangle);
  });

  function calculateTriangle() {
    const base = parseFloat(triangleBase.value) || 0;
    const height = parseFloat(triangleHeight.value) || 0;
    const a = parseFloat(triangleSideA.value) || 0;
    const b = parseFloat(triangleSideB.value) || 0;
    const c = parseFloat(triangleSideC.value) || 0;

    const area = (base * height) / 2;
    const perimeter = a + b + c;

    document.getElementById('triangleArea').textContent = area.toFixed(2);
    document.getElementById('trianglePerimeter').textContent = perimeter.toFixed(2);
  }

  // RECTANGLE
  const rectangleWidth = document.getElementById('rectangleWidth');
  const rectangleHeight = document.getElementById('rectangleHeight');

  [rectangleWidth, rectangleHeight].forEach(input => {
    input.addEventListener('input', calculateRectangle);
  });

  function calculateRectangle() {
    const w = parseFloat(rectangleWidth.value) || 0;
    const h = parseFloat(rectangleHeight.value) || 0;

    const area = w * h;
    const perimeter = 2 * (w + h);
    const diagonal = Math.sqrt(w * w + h * h);

    document.getElementById('rectangleArea').textContent = area.toFixed(2);
    document.getElementById('rectanglePerimeter').textContent = perimeter.toFixed(2);
    document.getElementById('rectangleDiagonal').textContent = diagonal.toFixed(2);
  }

  // SQUARE
  const squareSide = document.getElementById('squareSide');

  squareSide.addEventListener('input', calculateSquare);

  function calculateSquare() {
    const s = parseFloat(squareSide.value) || 0;

    const area = s * s;
    const perimeter = 4 * s;
    const diagonal = s * Math.sqrt(2);

    document.getElementById('squareArea').textContent = area.toFixed(2);
    document.getElementById('squarePerimeter').textContent = perimeter.toFixed(2);
    document.getElementById('squareDiagonal').textContent = diagonal.toFixed(2);
  }

  // TRAPEZOID
  const trapezoidBaseA = document.getElementById('trapezoidBaseA');
  const trapezoidBaseB = document.getElementById('trapezoidBaseB');
  const trapezoidHeight = document.getElementById('trapezoidHeight');
  const trapezoidSideC = document.getElementById('trapezoidSideC');
  const trapezoidSideD = document.getElementById('trapezoidSideD');

  [trapezoidBaseA, trapezoidBaseB, trapezoidHeight, trapezoidSideC, trapezoidSideD].forEach(input => {
    input.addEventListener('input', calculateTrapezoid);
  });

  function calculateTrapezoid() {
    const a = parseFloat(trapezoidBaseA.value) || 0;
    const b = parseFloat(trapezoidBaseB.value) || 0;
    const h = parseFloat(trapezoidHeight.value) || 0;
    const c = parseFloat(trapezoidSideC.value) || 0;
    const d = parseFloat(trapezoidSideD.value) || 0;

    const area = ((a + b) * h) / 2;
    const perimeter = a + b + c + d;

    document.getElementById('trapezoidArea').textContent = area.toFixed(2);
    document.getElementById('trapezoidPerimeter').textContent = perimeter.toFixed(2);
  }

  // CYLINDER
  const cylinderRadius = document.getElementById('cylinderRadius');
  const cylinderHeight = document.getElementById('cylinderHeight');

  [cylinderRadius, cylinderHeight].forEach(input => {
    input.addEventListener('input', calculateCylinder);
  });

  function calculateCylinder() {
    const r = parseFloat(cylinderRadius.value) || 0;
    const h = parseFloat(cylinderHeight.value) || 0;

    const volume = Math.PI * r * r * h;
    const surfaceArea = 2 * Math.PI * r * (r + h);
    const lateralArea = 2 * Math.PI * r * h;

    document.getElementById('cylinderVolume').textContent = volume.toFixed(2);
    document.getElementById('cylinderSurface').textContent = surfaceArea.toFixed(2);
    document.getElementById('cylinderLateral').textContent = lateralArea.toFixed(2);
  }

  // ========================================
  // MATH GAMES LOGIC
  // ========================================
  let selectedGrade = null;
  let selectedMode = null;
  let gameState = {
    score: 0,
    questionsAnswered: 0,
    correctAnswers: 0,
    totalQuestions: 10,
    lives: 3,
    timeLeft: 60,
    currentQuestion: null,
    timerInterval: null,
    startTime: null
  };

  // Grade button selection
  document.querySelectorAll('.grade-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.grade-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedGrade = parseInt(btn.dataset.grade);
      checkCanStart();
    });
  });

  // Game mode button selection
  document.querySelectorAll('.game-mode-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.game-mode-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedMode = btn.dataset.mode;
      checkCanStart();
    });
  });

  function checkCanStart() {
    document.getElementById('startGameBtn').disabled = !(selectedGrade && selectedMode);
  }

  document.getElementById('startGameBtn').addEventListener('click', startGame);
  document.getElementById('quitGameBtn').addEventListener('click', quitGame);

  function startGame() {
    // Reset game state
    gameState = {
      score: 0,
      questionsAnswered: 0,
      correctAnswers: 0,
      totalQuestions: selectedMode === 'speed' ? 999 : selectedMode === 'challenge' ? 20 : selectedMode === 'accuracy' ? 10 : 999,
      lives: selectedMode === 'challenge' ? 3 : 999,
      timeLeft: selectedMode === 'speed' ? 60 : 0,
      currentQuestion: null,
      timerInterval: null,
      startTime: Date.now()
    };

    // Show/hide UI elements based on mode
    document.getElementById('timerStat').style.display = selectedMode === 'speed' ? 'flex' : 'none';
    document.getElementById('livesStat').style.display = selectedMode === 'challenge' ? 'flex' : 'none';
    document.getElementById('questionStat').style.display = selectedMode === 'practice' || selectedMode === 'speed' ? 'none' : 'flex';

    // Switch screens
    document.getElementById('gameSetup').style.display = 'none';
    document.getElementById('gamePlay').classList.add('active');

    // Start timer for speed mode
    if (selectedMode === 'speed') {
      gameState.timerInterval = setInterval(() => {
        gameState.timeLeft--;
        document.getElementById('gameTimer').textContent = gameState.timeLeft;
        if (gameState.timeLeft <= 0) {
          endGame();
        }
      }, 1000);
    }

    // Generate first question
    generateQuestion();
  }

  function quitGame() {
    if (gameState.timerInterval) clearInterval(gameState.timerInterval);
    document.getElementById('gamePlay').classList.remove('active');
    document.getElementById('gameSetup').style.display = 'block';
  }

  function generateQuestion() {
    const question = createQuestionForGrade(selectedGrade);
    gameState.currentQuestion = question;
    displayQuestion(question);
  }

  function createQuestionForGrade(grade) {
    // Different math problems based on grade level
    let question = {};
    
    if (grade <= 2) {
      // 1st-2nd grade: Simple addition and subtraction (0-20)
      const ops = ['+', '-'];
      const op = ops[Math.floor(Math.random() * ops.length)];
      const a = Math.floor(Math.random() * 20) + 1;
      const b = Math.floor(Math.random() * 20) + 1;
      question = {
        text: `${a} ${op} ${b}`,
        answer: op === '+' ? a + b : a - b,
        type: 'input'
      };
    } else if (grade <= 4) {
      // 3rd-4th grade: Multiplication, division, larger addition/subtraction
      const ops = ['+', '-', '√ó', '√∑'];
      const op = ops[Math.floor(Math.random() * ops.length)];
      let a, b;
      if (op === '√ó') {
        a = Math.floor(Math.random() * 12) + 1;
        b = Math.floor(Math.random() * 12) + 1;
        question = { text: `${a} √ó ${b}`, answer: a * b, type: 'input' };
      } else if (op === '√∑') {
        b = Math.floor(Math.random() * 12) + 1;
        const result = Math.floor(Math.random() * 12) + 1;
        a = b * result;
        question = { text: `${a} √∑ ${b}`, answer: result, type: 'input' };
      } else {
        a = Math.floor(Math.random() * 100) + 1;
        b = Math.floor(Math.random() * 100) + 1;
        question = { text: `${a} ${op} ${b}`, answer: op === '+' ? a + b : a - b, type: 'input' };
      }
    } else if (grade <= 6) {
      // 5th-6th grade: Decimals, fractions, percentages, order of operations
      const types = ['decimal', 'percentage', 'order'];
      const type = types[Math.floor(Math.random() * types.length)];
      
      if (type === 'decimal') {
        const a = (Math.random() * 10).toFixed(1);
        const b = (Math.random() * 10).toFixed(1);
        const op = Math.random() > 0.5 ? '+' : '-';
        question = { text: `${a} ${op} ${b}`, answer: parseFloat((op === '+' ? parseFloat(a) + parseFloat(b) : parseFloat(a) - parseFloat(b)).toFixed(2)), type: 'input' };
      } else if (type === 'percentage') {
        const num = Math.floor(Math.random() * 100) + 1;
        const pct = [10, 20, 25, 50, 75][Math.floor(Math.random() * 5)];
        question = { text: `${pct}% of ${num}`, answer: (num * pct / 100), type: 'input' };
      } else {
        const a = Math.floor(Math.random() * 20) + 1;
        const b = Math.floor(Math.random() * 10) + 1;
        const c = Math.floor(Math.random() * 10) + 1;
        question = { text: `${a} + ${b} √ó ${c}`, answer: a + (b * c), type: 'input' };
      }
    } else if (grade <= 8) {
      // 7th-8th grade: Integers, exponents, simple algebra
      const types = ['negative', 'exponent', 'algebra'];
      const type = types[Math.floor(Math.random() * types.length)];
      
      if (type === 'negative') {
        const a = Math.floor(Math.random() * 20) - 10;
        const b = Math.floor(Math.random() * 20) - 10;
        const op = ['+', '-'][Math.floor(Math.random() * 2)];
        question = { text: `${a} ${op} (${b})`, answer: op === '+' ? a + b : a - b, type: 'input' };
      } else if (type === 'exponent') {
        const base = Math.floor(Math.random() * 10) + 2;
        const exp = Math.floor(Math.random() * 3) + 2;
        question = { text: `${base}^${exp}`, answer: Math.pow(base, exp), type: 'input' };
      } else {
        const coef = Math.floor(Math.random() * 10) + 1;
        const const1 = Math.floor(Math.random() * 20) + 1;
        const result = Math.floor(Math.random() * 20) + 1;
        const x = Math.floor((result - const1) / coef);
        question = { text: `${coef}x + ${const1} = ${result}`, answer: x, type: 'input', hint: 'Solve for x' };
      }
    } else {
      // 9th-12th grade: Advanced algebra, quadratics, trigonometry
      const types = ['quadratic', 'trig', 'logarithm'];
      const type = types[Math.floor(Math.random() * types.length)];
      
      if (type === 'quadratic') {
        const a = Math.floor(Math.random() * 5) + 1;
        const b = Math.floor(Math.random() * 10) - 5;
        const c = Math.floor(Math.random() * 10) - 5;
        const x = Math.floor(Math.random() * 5) + 1;
        const result = a * x * x + b * x + c;
        question = { text: `If ${a}x¬≤ + ${b}x + ${c} = ${result}, find x`, answer: x, type: 'multiple', choices: [x, x+1, x-1, x+2] };
      } else if (type === 'trig') {
        const angles = [0, 30, 45, 60, 90];
        const angle = angles[Math.floor(Math.random() * angles.length)];
        const funcs = ['sin', 'cos'];
        const func = funcs[Math.floor(Math.random() * funcs.length)];
        const values = {
          'sin': { 0: 0, 30: 0.5, 45: 0.707, 60: 0.866, 90: 1 },
          'cos': { 0: 1, 30: 0.866, 45: 0.707, 60: 0.5, 90: 0 }
        };
        question = { text: `${func}(${angle}¬∞)`, answer: values[func][angle], type: 'multiple', choices: [values[func][angle], 0.5, 0.707, 1] };
      } else {
        const base = [2, 10][Math.floor(Math.random() * 2)];
        const exp = Math.floor(Math.random() * 4) + 1;
        const result = Math.pow(base, exp);
        question = { text: `log‚Çç${base}‚Çé(${result})`, answer: exp, type: 'input' };
      }
    }

    // Shuffle choices for multiple choice
    if (question.type === 'multiple' && question.choices) {
      question.choices = question.choices.sort(() => Math.random() - 0.5);
    }

    return question;
  }

  function displayQuestion(question) {
    const content = document.getElementById('gameContent');
    
    if (question.type === 'input') {
      content.innerHTML = `
        <div class="question-display">${question.text}${question.hint ? '<br><small style="font-size:1rem;color:var(--muted);">' + question.hint + '</small>' : ''}</div>
        <input type="number" class="answer-input" id="answerInput" placeholder="?" step="any" autofocus />
        <button class="submit-answer-btn" id="submitAnswer">Submit</button>
      `;
      
      document.getElementById('answerInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') checkAnswer();
      });
      document.getElementById('submitAnswer').addEventListener('click', checkAnswer);
      document.getElementById('answerInput').focus();
    } else if (question.type === 'multiple') {
      content.innerHTML = `
        <div class="question-display">${question.text}</div>
        <div class="multiple-choice-grid" id="choicesGrid"></div>
      `;
      
      const grid = document.getElementById('choicesGrid');
      question.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice;
        btn.addEventListener('click', () => checkMultipleChoice(choice));
        grid.appendChild(btn);
      });
    }

    updateGameStats();
  }

  function checkAnswer() {
    const input = document.getElementById('answerInput');
    const userAnswer = parseFloat(input.value);
    const correct = Math.abs(userAnswer - gameState.currentQuestion.answer) < 0.01;

    if (correct) {
      input.classList.add('correct');
      gameState.score += 10;
      gameState.correctAnswers++;
      setTimeout(nextQuestion, 500);
    } else {
      input.classList.add('wrong');
      if (selectedMode === 'challenge') {
        gameState.lives--;
        updateLives();
        if (gameState.lives <= 0) {
          endGame();
          return;
        }
      }
      setTimeout(() => {
        input.classList.remove('wrong');
        input.value = '';
        input.focus();
      }, 400);
    }

    gameState.questionsAnswered++;
    updateGameStats();
  }

  function checkMultipleChoice(choice) {
    const correct = choice === gameState.currentQuestion.answer;
    const buttons = document.querySelectorAll('.choice-btn');
    
    buttons.forEach(btn => {
      btn.disabled = true;
      if (parseFloat(btn.textContent) === gameState.currentQuestion.answer) {
        btn.classList.add('correct');
      } else if (parseFloat(btn.textContent) === choice && !correct) {
        btn.classList.add('wrong');
      }
    });

    if (correct) {
      gameState.score += 10;
      gameState.correctAnswers++;
    } else if (selectedMode === 'challenge') {
      gameState.lives--;
      updateLives();
      if (gameState.lives <= 0) {
        setTimeout(endGame, 1000);
        return;
      }
    }

    gameState.questionsAnswered++;
    setTimeout(nextQuestion, 1000);
  }

  function nextQuestion() {
    if (selectedMode !== 'practice' && selectedMode !== 'speed' && gameState.questionsAnswered >= gameState.totalQuestions) {
      endGame();
      return;
    }
    generateQuestion();
  }

  function updateGameStats() {
    document.getElementById('gameScore').textContent = gameState.score;
    if (selectedMode !== 'practice' && selectedMode !== 'speed') {
      document.getElementById('gameQuestion').textContent = `${gameState.questionsAnswered + 1}/${gameState.totalQuestions}`;
    }
  }

  function updateLives() {
    const hearts = '‚ù§Ô∏è'.repeat(gameState.lives);
    document.getElementById('gameLives').textContent = hearts || 'üíÄ';
  }

  function endGame() {
    if (gameState.timerInterval) clearInterval(gameState.timerInterval);
    
    const timeElapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
    const accuracy = gameState.questionsAnswered > 0 ? Math.round((gameState.correctAnswers / gameState.questionsAnswered) * 100) : 0;

    const content = document.getElementById('gameContent');
    content.innerHTML = `
      <div class="game-over-screen">
        <h2>üéâ Game Over!</h2>
        <div class="final-score">${gameState.score} points</div>
        <div class="game-stats-grid">
          <div class="game-stat-card">
            <div class="game-stat-card-label">Questions</div>
            <div class="game-stat-card-value">${gameState.questionsAnswered}</div>
          </div>
          <div class="game-stat-card">
            <div class="game-stat-card-label">Correct</div>
            <div class="game-stat-card-value">${gameState.correctAnswers}</div>
          </div>
          <div class="game-stat-card">
            <div class="game-stat-card-label">Accuracy</div>
            <div class="game-stat-card-value">${accuracy}%</div>
          </div>
          <div class="game-stat-card">
            <div class="game-stat-card-label">Time</div>
            <div class="game-stat-card-value">${timeElapsed}s</div>
          </div>
        </div>
        <div class="game-buttons">
          <button class="game-btn primary" id="playAgainBtn">Play Again</button>
          <button class="game-btn secondary" id="mainMenuBtn">Main Menu</button>
        </div>
      </div>
    `;

    document.getElementById('playAgainBtn').addEventListener('click', startGame);
    document.getElementById('mainMenuBtn').addEventListener('click', quitGame);
  }

  // ========================================
  // CONVERTER LOGIC
  // ========================================
  const categories = {
    length: {
      mm:  { name: 'Millimeters', toBase: 0.001 },
      cm:  { name: 'Centimeters', toBase: 0.01 },
      m:   { name: 'Meters', toBase: 1 },
      km:  { name: 'Kilometers', toBase: 1000 },
      in:  { name: 'Inches', toBase: 0.0254 },
      ft:  { name: 'Feet', toBase: 0.3048 },
      yd:  { name: 'Yards', toBase: 0.9144 },
      mi:  { name: 'Miles', toBase: 1609.344 },
    },
    weight: {
      mg:  { name: 'Milligrams', toBase: 0.000001 },
      g:   { name: 'Grams', toBase: 0.001 },
      kg:  { name: 'Kilograms', toBase: 1 },
      ton: { name: 'Metric Tons', toBase: 1000 },
      oz:  { name: 'Ounces', toBase: 0.0283495 },
      lb:  { name: 'Pounds', toBase: 0.453592 },
      st:  { name: 'Stones', toBase: 6.35029 },
      ton_us: { name: 'US Tons', toBase: 907.185 },
    },
    volume: {
      ml:  { name: 'Milliliters', toBase: 0.001 },
      l:   { name: 'Liters', toBase: 1 },
      tsp: { name: 'Teaspoons', toBase: 0.00492892 },
      tbsp:{ name: 'Tablespoons', toBase: 0.0147868 },
      floz:{ name: 'Fluid Ounces', toBase: 0.0295735 },
      cup: { name: 'Cups', toBase: 0.236588 },
      pt:  { name: 'Pints', toBase: 0.473176 },
      qt:  { name: 'Quarts', toBase: 0.946353 },
      gal: { name: 'Gallons', toBase: 3.78541 },
    },
    temp: {
      c:   { name: 'Celsius' },
      f:   { name: 'Fahrenheit' },
      k:   { name: 'Kelvin' },
    }
  };

  const quickExamples = {
    length: [
      { from: '1 m', to: '3.281 ft' },
      { from: '1 km', to: '0.621 mi' },
      { from: '1 in', to: '2.54 cm' },
      { from: '1 mi', to: '1.609 km' },
    ],
    weight: [
      { from: '1 kg', to: '2.205 lb' },
      { from: '1 lb', to: '453.592 g' },
      { from: '1 oz', to: '28.35 g' },
      { from: '1 ton', to: '2204.62 lb' },
    ],
    volume: [
      { from: '1 l', to: '33.814 fl oz' },
      { from: '1 gal', to: '3.785 l' },
      { from: '1 cup', to: '236.59 ml' },
      { from: '1 ml', to: '0.034 fl oz' },
    ],
    temp: [
      { from: '0 ¬∞C', to: '32 ¬∞F' },
      { from: '100 ¬∞C', to: '212 ¬∞F' },
      { from: '273.15 K', to: '0 ¬∞C' },
      { from: '20 ¬∞C', to: '68 ¬∞F' },
    ],
  };

  let currentCategory = 'length';

  const inputValue      = document.getElementById('inputValue');
  const fromUnit        = document.getElementById('fromUnit');
  const toUnit          = document.getElementById('toUnit');
  const swapBtn         = document.getElementById('swapBtn');
  const convResultValue = document.getElementById('convResultValue');
  const convResultFormula= document.getElementById('convResultFormula');
  const quickList       = document.getElementById('quickList');

  document.querySelectorAll('.cat-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelector('.cat-tab.active').classList.remove('active');
      tab.classList.add('active');
      currentCategory = tab.dataset.category;
      populateUnits();
      convert();
      renderQuickList();
    });
  });

  swapBtn.addEventListener('click', () => {
    const temp = fromUnit.value;
    fromUnit.value = toUnit.value;
    toUnit.value = temp;
    convert();
  });

  inputValue.addEventListener('input', convert);
  fromUnit.addEventListener('change', convert);
  toUnit.addEventListener('change', convert);

  function populateUnits() {
    const units = categories[currentCategory];
    fromUnit.innerHTML = '';
    toUnit.innerHTML = '';

    Object.keys(units).forEach((key, idx) => {
      const opt1 = document.createElement('option');
      opt1.value = key;
      opt1.textContent = units[key].name;
      fromUnit.appendChild(opt1);

      const opt2 = document.createElement('option');
      opt2.value = key;
      opt2.textContent = units[key].name;
      toUnit.appendChild(opt2);

      if (idx === 0) fromUnit.value = key;
      if (idx === 1) toUnit.value = key;
    });
  }

  function convert() {
    const val = parseFloat(inputValue.value);
    if (isNaN(val)) {
      convResultValue.textContent = '‚Äî';
      convResultFormula.textContent = '';
      return;
    }

    const from = fromUnit.value;
    const to   = toUnit.value;

    let result, formula;

    if (currentCategory === 'temp') {
      result = convertTemp(val, from, to);
      formula = getTempFormula(from, to);
    } else {
      const units = categories[currentCategory];
      const fromBase = units[from].toBase;
      const toBase   = units[to].toBase;
      result = val * (fromBase / toBase);
      formula = `${val} √ó ${(fromBase / toBase).toFixed(6)} = ${result.toFixed(6)}`;
    }

    convResultValue.textContent = formatConvNumber(result);
    convResultFormula.textContent = formula;
  }

  function convertTemp(val, from, to) {
    let celsius;
    if (from === 'c') celsius = val;
    else if (from === 'f') celsius = (val - 32) * 5/9;
    else if (from === 'k') celsius = val - 273.15;

    if (to === 'c') return celsius;
    if (to === 'f') return celsius * 9/5 + 32;
    if (to === 'k') return celsius + 273.15;
  }

  function getTempFormula(from, to) {
    if (from === to) return 'Same unit';
    if (from === 'c' && to === 'f') return '¬∞C √ó 9/5 + 32';
    if (from === 'f' && to === 'c') return '(¬∞F ‚àí 32) √ó 5/9';
    if (from === 'c' && to === 'k') return '¬∞C + 273.15';
    if (from === 'k' && to === 'c') return 'K ‚àí 273.15';
    if (from === 'f' && to === 'k') return '(¬∞F ‚àí 32) √ó 5/9 + 273.15';
    if (from === 'k' && to === 'f') return '(K ‚àí 273.15) √ó 9/5 + 32';
    return '';
  }

  function formatConvNumber(num) {
    if (Math.abs(num) > 1e6 || (Math.abs(num) < 0.001 && num !== 0)) {
      return num.toExponential(4);
    }
    const rounded = Math.round(num * 1e8) / 1e8;
    return rounded.toLocaleString('en-US', { maximumFractionDigits: 8 });
  }

  function renderQuickList() {
    const examples = quickExamples[currentCategory];
    quickList.innerHTML = '';
    examples.forEach(ex => {
      const div = document.createElement('div');
      div.className = 'quick-item';
      div.innerHTML = `<span>${ex.from}</span><span>${ex.to}</span>`;
      quickList.appendChild(div);
    });
  }

  // init converter
  populateUnits();
  convert();
  renderQuickList();
})();
</script>
</body>
</html>
